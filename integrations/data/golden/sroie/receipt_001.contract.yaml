schema_id: sroie_receipt_v1

assertions:
  required_keys:
    - company
    - address
    - date
    - total

  non_empty_if_present:
    - company
    - address
    - date
    - total

  regex_any_of_if_present:
    date:
      # 27/03/2018 or 23/06/18
      - "^[0-9]{1,2}/[0-9]{1,2}/[0-9]{2,4}$"

      # 05-JAN-2017 (accept case-insensitive month)
      - "^[0-9]{1,2}-[A-Za-z]{3}-[0-9]{4}$"

      # 16 MAY 2018 / 22 MAR 2018 (allow 3+ letter month, extra spaces)
      - "^[0-9]{1,2}\\s+[A-Za-z]{3,9}\\s+[0-9]{4}$"

    total:
      # currency optional, digits, optional decimals (allow spaces)
      - "^\\s*[$€£]?\\s*[0-9]+(\\.[0-9]{2})?\\s*$"

notes: >
  Voxel51 scanned_receipts samples appear to always include company/address/date/total.
  Date formats observed: DD/MM/YYYY, DD/MM/YY, DD-MON-YYYY, DD MON YYYY.
  Total may include a currency symbol; decimals usually present but not required by contract.